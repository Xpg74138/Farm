var _=Object.defineProperty;var k=(d,e,s)=>e in d?_(d,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):d[e]=s;var i=(d,e,s)=>k(d,typeof e!="symbol"?e+"":e,s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&t(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function t(a){if(a.ep)return;a.ep=!0;const n=s(a);fetch(a.href,n)}})();class A{constructor(e){i(this,"currentRoute");i(this,"routes");i(this,"rootElement");this.currentRoute="start",this.routes=new Map,this.rootElement=e,window.addEventListener("hashchange",()=>{this.handleHashChange()})}registerRoute(e,s){this.routes.set(e,s),s.className=`page ${e===this.currentRoute?"":"hidden"}`,this.rootElement.appendChild(s)}navigate(e){if(this.routes.has(e)){const s=this.routes.get(this.currentRoute);s&&s.classList.add("hidden");const t=this.routes.get(e);t&&t.classList.remove("hidden"),this.currentRoute=e,window.location.hash=e}}getCurrentRoute(){return this.currentRoute}handleHashChange(){const e=window.location.hash.slice(1)||"start";this.routes.has(e)&&this.navigate(e)}init(){const e=window.location.hash.slice(1)||"start";this.navigate(e)}}class w{constructor(){i(this,"state");i(this,"BASE_MAX_PIGS",5);i(this,"PEN_UPGRADE_COST",1e3);i(this,"PEN_UPGRADE_INCREASE",5);i(this,"FEED_PER_PIG",2);this.state=this.getInitialState()}getInitialState(){return{money:1e3,feedStock:50,feedConsumption:0,fatteningPigs:2,readyPigs:0,maxPigs:this.BASE_MAX_PIGS}}getState(){return{...this.state}}setState(e){this.state={...this.state,...e}}buyFeed(e,s){const t=e*s;return this.state.money<t?!1:(this.state.money-=t,this.state.feedStock+=e,!0)}buyPig(e,s){const t=e*s,a=this.state.fatteningPigs+this.state.readyPigs+e;return this.state.money<t||a>this.state.maxPigs?!1:(this.state.money-=t,this.state.fatteningPigs+=e,!0)}sellPig(e,s){if(this.state.readyPigs<e)return!1;const t=e*s;return this.state.money+=t,this.state.readyPigs-=e,!0}upgradePen(){return this.state.money<this.PEN_UPGRADE_COST?!1:(this.state.money-=this.PEN_UPGRADE_COST,this.state.maxPigs+=this.PEN_UPGRADE_INCREASE,!0)}passDay(){const e=this.state.fatteningPigs+this.state.readyPigs,s=Math.min(this.state.feedStock,e*this.FEED_PER_PIG);if(this.state.feedConsumption=s,this.state.feedStock-=s,s>=e*this.FEED_PER_PIG){const t=Math.floor(this.state.fatteningPigs*.2);t>0&&(this.state.fatteningPigs-=t,this.state.readyPigs+=t)}}}class B{constructor(){i(this,"state");i(this,"BASE_PORK_PRICE",20);i(this,"BASE_FEED_PRICE",5);i(this,"BASE_PIGLET_PRICE",250);i(this,"PORK_PRICE_FLUCTUATION",.2);i(this,"FEED_PRICE_FLUCTUATION",.2);i(this,"PIGLET_PRICE_FLUCTUATION",.2);i(this,"PIGLET_PRICE_MIN",200);i(this,"PIGLET_PRICE_MAX",300);this.state=this.getInitialState()}getInitialState(){return{porkPrice:this.BASE_PORK_PRICE,feedPrice:this.BASE_FEED_PRICE,pigletPrice:this.BASE_PIGLET_PRICE}}getState(){return{...this.state}}setState(e){this.state={...this.state,...e}}updateMarket(){const e=this.BASE_PORK_PRICE*this.PORK_PRICE_FLUCTUATION;this.state.porkPrice=parseFloat((this.BASE_PORK_PRICE+(Math.random()*e*2-e)).toFixed(2));const s=this.BASE_FEED_PRICE*this.FEED_PRICE_FLUCTUATION;this.state.feedPrice=parseFloat((this.BASE_FEED_PRICE+(Math.random()*s*2-s)).toFixed(2));const t=this.BASE_PIGLET_PRICE*this.PIGLET_PRICE_FLUCTUATION;let a=parseFloat((this.BASE_PIGLET_PRICE+(Math.random()*t*2-t)).toFixed(2));this.state.pigletPrice=Math.max(this.PIGLET_PRICE_MIN,Math.min(this.PIGLET_PRICE_MAX,a))}getMarketSummary(){return`猪肉价格：¥${this.state.porkPrice}/kg，饲料价格：¥${this.state.feedPrice}/单位，仔猪价格：¥${this.state.pigletPrice}/只`}}class N{constructor(){i(this,"eventTemplates");this.eventTemplates=[{title:"市场需求上升",description:"最近猪肉市场需求增加，价格可能会上涨。",type:"opportunity",probability:.3,effect:{money:100}},{title:"饲料价格波动",description:"由于天气原因，饲料价格出现了波动。",type:"warning",probability:.25,effect:{money:-50}},{title:"猪群健康问题",description:"部分猪出现了健康问题，需要额外的饲料和护理。",type:"danger",probability:.15,effect:{money:-100,feedStock:-20,fatteningPigs:-1}},{title:"政府补贴",description:"政府推出了养猪补贴政策，你获得了一笔补贴。",type:"opportunity",probability:.1,effect:{money:200}},{title:"技术培训",description:"参加了养猪技术培训，学到了新的养殖方法。",type:"info",probability:.2,effect:{money:-50,fatteningPigs:1}},{title:"新客户订单",description:"收到了一个大额猪肉订单，可以获得额外收入。",type:"opportunity",probability:.15,effect:{money:300}},{title:"设备损坏",description:"猪舍的一些设备损坏了，需要维修。",type:"danger",probability:.1,effect:{money:-150}},{title:"饲料丰收",description:"附近的饲料厂丰收，饲料价格下降。",type:"info",probability:.2,effect:{feedStock:30,money:-50}}]}generateRandomEvent(e){const s=Math.random();let t=0;for(const a of this.eventTemplates)if(t+=a.probability,s<=t)return{id:`event-${Date.now()}-${Math.floor(Math.random()*1e3)}`,title:a.title,description:a.description,type:a.type,day:e,resolved:!1,effect:a.effect};return null}generateDailyEvents(e,s=2){const t=[];for(let a=0;a<s;a++){const n=this.generateRandomEvent(e);n&&t.push(n)}return t}applyEventEffect(e){var s,t,a,n;return{money:((s=e.effect)==null?void 0:s.money)||0,feedStock:((t=e.effect)==null?void 0:t.feedStock)||0,fatteningPigs:((a=e.effect)==null?void 0:a.fatteningPigs)||0,readyPigs:((n=e.effect)==null?void 0:n.readyPigs)||0}}resolveEvent(e){return{...e,resolved:!0}}}class E{constructor(){i(this,"state");i(this,"farmer");i(this,"market");i(this,"eventManager");this.farmer=new w,this.market=new B,this.eventManager=new N,this.state=this.getInitialState()}getInitialState(){return{characterType:"farmer",pigState:{health:100,hunger:50,happiness:70,weight:1,age:0,isAlive:!0},farmerState:this.farmer.getState(),marketState:this.market.getState(),day:1,gameSpeed:3,volume:50,events:[]}}getState(){return{...this.state,farmerState:this.farmer.getState(),marketState:this.market.getState()}}loadState(e){this.state={...e,farmerState:e.farmerState,marketState:e.marketState,events:e.events||[]},this.farmer.setState(e.farmerState),this.market.setState(e.marketState)}farmerBuyFeed(e){return this.farmer.buyFeed(e,this.market.getState().feedPrice)}farmerSellPig(e){const t=100*this.market.getState().porkPrice;return this.farmer.sellPig(e,t)}farmerBuyPig(e){const s=this.market.getState().pigletPrice;return this.farmer.buyPig(e,s)}farmerUpgradePen(){return this.farmer.upgradePen()}passDay(){this.state.day+=1,this.farmer.passDay(),this.market.updateMarket(),this.generateDailyEvents()}generateDailyEvents(){const e=this.eventManager.generateDailyEvents(this.state.day);this.state.events=[...this.state.events,...e]}getEvents(){return this.state.events}setGameSpeed(e){this.state.gameSpeed=Math.max(1,Math.min(5,e))}setVolume(e){this.state.volume=Math.max(0,Math.min(100,e))}getFarmer(){return this.farmer}getMarket(){return this.market}}class h{constructor(e,s,t="pixel-btn"){i(this,"element");this.element=document.createElement("button"),this.element.textContent=e,this.element.className=t,this.element.addEventListener("click",s)}getElement(){return this.element}setText(e){this.element.textContent=e}disable(){this.element.disabled=!0,this.element.classList.add("disabled")}enable(){this.element.disabled=!1,this.element.classList.remove("disabled")}destroy(){this.element.remove()}}class R{constructor(e,s,t){i(this,"element");i(this,"onStartGame");i(this,"onLoadGame");i(this,"onSettings");this.element=document.createElement("div"),this.element.className="page start-page",this.onStartGame=e,this.onLoadGame=s,this.onSettings=t,this.render()}render(){const e=document.createElement("div");e.className="pixel-container";const s=document.createElement("h1");s.className="pixel-title",s.textContent="养猪模拟器",e.appendChild(s);const t=document.createElement("h2");t.className="pixel-subtitle",t.textContent="一个有趣的文字模拟经营游戏",e.appendChild(t);const a=document.createElement("div");a.style.display="flex",a.style.flexDirection="column",a.style.alignItems="center",a.style.gap="15px",a.style.marginTop="30px";const n=new h("开始游戏",this.onStartGame);a.appendChild(n.getElement());const l=new h("加载游戏",this.onLoadGame);a.appendChild(l.getElement());const o=new h("设置",this.onSettings);a.appendChild(o.getElement()),e.appendChild(a),this.element.appendChild(e)}getElement(){return this.element}}class T{constructor(e,s,t,a,n,l){i(this,"element");i(this,"onBuyFeed");i(this,"onSellPig");i(this,"onBuyPig");i(this,"onUpgradePen");i(this,"onNextDay");i(this,"onBack");i(this,"farmerState");i(this,"marketState");i(this,"events");i(this,"day");this.element=document.createElement("div"),this.element.className="page farmer-game-page",this.onBuyFeed=e,this.onSellPig=s,this.onBuyPig=t,this.onUpgradePen=a,this.onNextDay=n,this.onBack=l,this.farmerState={money:1e3,feedStock:50,feedConsumption:0,fatteningPigs:2,readyPigs:0,maxPigs:5},this.marketState={porkPrice:20,feedPrice:5,pigletPrice:250},this.events=[],this.day=1,this.render()}render(){const e=document.createElement("div");e.className="game-container";const s=document.createElement("h1");s.className="pixel-title",s.textContent="养猪场管理",e.appendChild(s);const t=document.createElement("div");t.className="day-display",t.textContent=`第 ${this.day} 天`,e.appendChild(t);const a=document.createElement("div");a.className="game-main",a.style.display="flex",a.style.gap="30px",a.style.width="100%";const n=this.createEventArea();a.appendChild(n);const l=document.createElement("div");l.style.flex="1",l.style.display="flex",l.style.flexDirection="column",l.style.gap="20px";const o=document.createElement("div");o.className="pixel-container",o.style.width="100%";const c=document.createElement("h3");c.className="pixel-subtitle",c.style.fontSize="20px",c.textContent="农场状态",o.appendChild(c);const r=document.createElement("div");r.style.display="grid",r.style.gridTemplateColumns="repeat(2, 1fr)",r.style.gap="15px",r.appendChild(this.createStatItem("金钱",`¥${this.farmerState.money}`)),r.appendChild(this.createStatItem("饲料库存",`${this.farmerState.feedStock} 单位`)),r.appendChild(this.createStatItem("饲料消耗",`${this.farmerState.feedConsumption} 单位/天`)),r.appendChild(this.createStatItem("育肥猪",`${this.farmerState.fatteningPigs}`)),r.appendChild(this.createStatItem("可出栏猪",`${this.farmerState.readyPigs}`));const m=this.farmerState.fatteningPigs+this.farmerState.readyPigs;r.appendChild(this.createStatItem("总猪数量",`${m}/${this.farmerState.maxPigs}`)),o.appendChild(r),l.appendChild(o);const g=document.createElement("div");g.className="pixel-container",g.style.width="100%";const p=document.createElement("h3");p.className="pixel-subtitle",p.style.fontSize="20px",p.textContent="市场信息",g.appendChild(p);const u=document.createElement("div");u.style.display="grid",u.style.gridTemplateColumns="repeat(2, 1fr)",u.style.gap="15px",u.appendChild(this.createStatItem("猪肉价格",`¥${this.marketState.porkPrice}/kg`)),u.appendChild(this.createStatItem("饲料价格",`¥${this.marketState.feedPrice}/单位`)),u.appendChild(this.createStatItem("仔猪价格",`¥${this.marketState.pigletPrice}/只`)),g.appendChild(u),l.appendChild(g);const y=document.createElement("div");y.className="game-controls",y.style.flexWrap="wrap",y.style.justifyContent="center";const P=new h("购买饲料",()=>this.showQuantityModal("购买饲料",this.onBuyFeed,this.calculateMaxBuyFeed()));y.appendChild(P.getElement());const C=new h("出售猪",()=>this.showQuantityModal("出售猪",this.onSellPig,this.farmerState.readyPigs));y.appendChild(C.getElement());const x=new h("购买猪仔",()=>this.showQuantityModal("购买猪仔",this.onBuyPig,this.calculateMaxBuyPig()));y.appendChild(x.getElement());const I=new h("升级猪舍",this.onUpgradePen);y.appendChild(I.getElement());const S=new h("下一天",this.onNextDay);S.getElement().style.backgroundColor="#2E8B57",S.getElement().style.marginTop="15px",S.getElement().style.padding="15px 30px",S.getElement().style.fontSize="18px",y.appendChild(S.getElement());const b=new h("返回",this.onBack);y.appendChild(b.getElement()),l.appendChild(y),a.appendChild(l),e.appendChild(a),this.element.appendChild(e)}calculateMaxBuyFeed(){return Math.floor(this.farmerState.money/this.marketState.feedPrice)}calculateMaxBuyPig(){const e=this.farmerState.fatteningPigs+this.farmerState.readyPigs,s=this.farmerState.maxPigs-e,t=Math.floor(this.farmerState.money/this.marketState.pigletPrice);return Math.max(0,Math.min(s,t))}showQuantityModal(e,s,t){const a=document.createElement("div");a.className="modal-overlay",a.style.position="fixed",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="100%",a.style.backgroundColor="rgba(0, 0, 0, 0.5)",a.style.display="flex",a.style.justifyContent="center",a.style.alignItems="center",a.style.zIndex="1000";const n=document.createElement("div");n.className="pixel-container",n.style.padding="20px",n.style.backgroundColor="#f0e68c",n.style.border="3px solid #000",n.style.borderRadius="8px",n.style.width="300px",n.style.textAlign="center";const l=document.createElement("h3");l.className="pixel-subtitle",l.style.marginBottom="15px",l.textContent=e,n.appendChild(l);const o=document.createElement("div");o.style.marginBottom="15px";const c=document.createElement("label");c.textContent=`数量 (最大: ${t}): `,c.style.display="block",c.style.marginBottom="5px",o.appendChild(c);const r=document.createElement("input");r.type="number",r.min="1",r.max=t.toString(),r.value="1",r.style.padding="8px",r.style.fontSize="16px",r.style.border="2px solid #000",r.style.borderRadius="4px",r.style.width="100px",r.style.textAlign="center",o.appendChild(r),n.appendChild(o);const m=document.createElement("div");m.style.display="flex",m.style.justifyContent="space-around",m.style.marginTop="20px";const g=new h("确认",()=>{const u=parseInt(r.value);u>=1&&u<=t&&(s(u),a.remove())});m.appendChild(g.getElement());const p=new h("取消",()=>{a.remove()});m.appendChild(p.getElement()),n.appendChild(m),a.appendChild(n),document.body.appendChild(a),r.focus()}createEventArea(){const e=document.createElement("div");e.className="pixel-container",e.style.width="250px",e.style.height="auto",e.style.minHeight="400px",e.style.display="flex",e.style.flexDirection="column";const s=document.createElement("h3");s.className="pixel-subtitle",s.style.fontSize="20px",s.textContent="今日事件",e.appendChild(s);const t=document.createElement("div");if(t.className="event-list",t.style.flex="1",t.style.overflowY="auto",t.style.marginTop="15px",this.events.length===0){const a=document.createElement("div");a.className="event-item event-info",a.style.padding="10px",a.style.textAlign="center",a.textContent="今天没有特殊事件发生。",t.appendChild(a)}else{const a=this.events.filter(n=>n.day===this.day);if(a.length===0){const n=document.createElement("div");n.className="event-item event-info",n.style.padding="10px",n.style.textAlign="center",n.textContent="今天没有特殊事件发生。",t.appendChild(n)}else a.forEach(n=>{const l=this.createEventItem(n.title,n.description,n.type);t.appendChild(l)})}return e.appendChild(t),e}createEventItem(e,s,t){const a=document.createElement("div");switch(a.className=`event-item event-${t}`,a.style.padding="10px",a.style.marginBottom="10px",a.style.borderRadius="4px",a.style.border="2px solid #000",a.style.backgroundColor="#FFFACD",t){case"opportunity":a.style.backgroundColor="#98FB98";break;case"warning":a.style.backgroundColor="#FFD700";break;case"danger":a.style.backgroundColor="#FFB6C1";break}const n=document.createElement("h4");n.style.fontSize="14px",n.style.fontWeight="bold",n.style.marginBottom="5px",n.textContent=e,a.appendChild(n);const l=document.createElement("p");l.style.fontSize="12px",l.textContent=s,a.appendChild(l);const o=this.getEventEffectText(e);if(o){const c=document.createElement("p");c.style.fontSize="12px",c.style.fontWeight="bold",c.style.marginTop="5px",c.style.color=o.includes("增加")?"#2E8B57":"#DC143C",c.textContent=o,a.appendChild(c)}return a}getEventEffectText(e){switch(e){case"市场需求上升":return"金钱增加：+¥100";case"饲料价格波动":return"金钱减少：-¥50";case"猪群健康问题":return"金钱减少：-¥100，饲料减少：-20单位，育肥猪减少：-1头";case"政府补贴":return"金钱增加：+¥200";case"技术培训":return"金钱减少：-¥50，育肥猪增加：+1头";case"新客户订单":return"金钱增加：+¥300";case"设备损坏":return"金钱减少：-¥150";case"饲料丰收":return"饲料增加：+30单位，金钱减少：-¥50";default:return""}}createStatItem(e,s){const t=document.createElement("div");return t.className="stat-item",t.innerHTML=`<span>${e}:</span> <span>${s}</span>`,t}updateState(e,s,t=[],a=1){this.farmerState=e,this.marketState=s,this.events=t,this.day=a,this.element.innerHTML="",this.render()}getElement(){return this.element}}class F{constructor(e,s,t){i(this,"element");i(this,"onBack");i(this,"onSaveSettings");i(this,"onClearSaves");i(this,"gameSpeed",3);i(this,"volume",50);this.element=document.createElement("div"),this.element.className="page settings-page",this.onBack=e,this.onSaveSettings=s,this.onClearSaves=t,this.render()}render(){const e=document.createElement("div");e.className="pixel-container";const s=document.createElement("h1");s.className="pixel-title",s.textContent="设置",e.appendChild(s);const t=document.createElement("div");t.style.display="flex",t.style.flexDirection="column",t.style.gap="20px",t.style.marginTop="20px";const a=this.createSliderSetting("游戏速度",1,5,this.gameSpeed,p=>{this.gameSpeed=p});t.appendChild(a);const n=this.createSliderSetting("音量",0,100,this.volume,p=>{this.volume=p});t.appendChild(n),e.appendChild(t);const l=document.createElement("div");l.style.marginTop="30px";const o=document.createElement("h3");o.className="pixel-subtitle",o.style.fontSize="20px",o.textContent="存档管理",l.appendChild(o);const c=new h("清除所有存档",()=>{confirm("确定要清除所有存档吗？此操作不可恢复！")&&this.onClearSaves()});l.appendChild(c.getElement()),e.appendChild(l);const r=document.createElement("div");r.style.display="flex",r.style.justifyContent="center",r.style.gap="15px",r.style.marginTop="30px";const m=new h("保存设置",()=>{this.onSaveSettings(this.gameSpeed,this.volume)});r.appendChild(m.getElement());const g=new h("返回",this.onBack);r.appendChild(g.getElement()),e.appendChild(r),this.element.appendChild(e)}createSliderSetting(e,s,t,a,n){const l=document.createElement("div");l.style.display="flex",l.style.flexDirection="column",l.style.gap="10px";const o=document.createElement("div");o.className="pixel-text",o.style.fontWeight="bold",o.textContent=e,l.appendChild(o);const c=document.createElement("div");c.style.display="flex",c.style.alignItems="center",c.style.gap="10px";const r=document.createElement("input");r.type="range",r.min=s.toString(),r.max=t.toString(),r.value=a.toString(),r.className="slider",r.style.flex="1",r.style.height="10px",r.style.accentColor="#8B4513",r.addEventListener("input",g=>{const p=parseInt(g.target.value);n(p),m.textContent=p.toString()});const m=document.createElement("span");return m.className="pixel-text",m.textContent=a.toString(),m.style.minWidth="30px",m.style.textAlign="right",c.appendChild(r),c.appendChild(m),l.appendChild(c),l}getElement(){return this.element}setInitialValues(e,s){this.gameSpeed=e,this.volume=s,this.element.innerHTML="",this.render()}}class f{static getAllSaves(){const e=localStorage.getItem(this.SAVE_KEY);return e?JSON.parse(e):[]}static saveGame(e,s){const t=this.getAllSaves(),a={id:Date.now().toString(),name:e,timestamp:Date.now(),state:s};t.push(a),localStorage.setItem(this.SAVE_KEY,JSON.stringify(t))}static autoSave(e){localStorage.setItem(this.AUTO_SAVE_KEY,JSON.stringify(e))}static loadAutoSave(){const e=localStorage.getItem(this.AUTO_SAVE_KEY);return e?JSON.parse(e):null}static loadGame(e){const t=this.getAllSaves().find(a=>a.id===e);return t?t.state:null}static deleteSave(e){const t=this.getAllSaves().filter(a=>a.id!==e);localStorage.setItem(this.SAVE_KEY,JSON.stringify(t))}static clearAllSaves(){localStorage.removeItem(this.SAVE_KEY),localStorage.removeItem(this.AUTO_SAVE_KEY)}}i(f,"SAVE_KEY","pigFarmSimulator_saves"),i(f,"AUTO_SAVE_KEY","pigFarmSimulator_autoSave");class G{constructor(){i(this,"listeners",new Map)}subscribe(e,s){var t;this.listeners.has(e)||this.listeners.set(e,[]),(t=this.listeners.get(e))==null||t.push(s)}unsubscribe(e,s){const t=this.listeners.get(e);if(t){const a=t.indexOf(s);a!==-1&&t.splice(a,1)}}publish(e){const s=this.listeners.get(e.type);s&&s.forEach(t=>t(e))}clear(){this.listeners.clear()}}class M{constructor(e){i(this,"router");i(this,"gameState");i(this,"eventService");i(this,"autoSaveInterval",null);i(this,"startPage");i(this,"farmerGamePage");i(this,"settingsPage");this.router=new A(e),this.gameState=new E,this.eventService=new G,this.startPage=new R(()=>this.startGame(),()=>this.loadGame(),()=>this.router.navigate("settings")),this.farmerGamePage=new T(s=>this.handleFarmerAction("buyFeed",s),s=>this.handleFarmerAction("sellPig",s),s=>this.handleFarmerAction("buyPig",s),()=>this.handleFarmerAction("upgradePen"),()=>this.nextDay(),()=>this.router.navigate("start")),this.settingsPage=new F(()=>this.router.navigate("start"),(s,t)=>this.saveSettings(s,t),()=>this.clearSaves())}init(){this.router.registerRoute("start",this.startPage.getElement()),this.router.registerRoute("farmer-game",this.farmerGamePage.getElement()),this.router.registerRoute("settings",this.settingsPage.getElement());const e=f.loadAutoSave();e&&(this.gameState.loadState(e),this.updateGameUI()),this.router.init(),this.autoSaveInterval=window.setInterval(()=>{this.autoSave()},3e4)}nextDay(){this.gameState.passDay(),this.updateGameUI(),this.autoSave()}startGame(){this.router.navigate("farmer-game"),this.updateGameUI()}loadGame(){const e=f.loadAutoSave();e&&(this.gameState.loadState(e),this.router.navigate("farmer-game"),this.updateGameUI())}handleFarmerAction(e,s=1){let t=!0;switch(e){case"buyFeed":t=this.gameState.farmerBuyFeed(s);break;case"sellPig":t=this.gameState.farmerSellPig(s);break;case"buyPig":t=this.gameState.farmerBuyPig(s);break;case"upgradePen":t=this.gameState.farmerUpgradePen();break}t?(this.updateGameUI(),this.autoSave()):console.log("Action failed!")}saveSettings(e,s){this.gameState.setGameSpeed(e),this.gameState.setVolume(s),this.autoSave()}clearSaves(){f.clearAllSaves(),this.gameState=new E,this.updateGameUI()}autoSave(){const e=this.gameState.getState();f.autoSave(e)}updateGameUI(){const e=this.gameState.getState();this.farmerGamePage.updateState(e.farmerState,e.marketState,e.events,e.day)}destroy(){this.autoSaveInterval&&clearInterval(this.autoSaveInterval),this.eventService.clear()}}const v=document.getElementById("app");v&&new M(v).init();
//# sourceMappingURL=index-BtVzOgQX.js.map
